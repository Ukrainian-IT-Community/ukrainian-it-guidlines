[<-- Повернутись назад](index.md)

## Зрозумійте різні концепції ОС

Перш ніж ознайомлюватися детально про концепції операційних систем, необхідно мати загальне уявлення про те, що таке саме операційна система та які її задача, принципи. Ознайомитися з цим можна у статті [Операційна система (ОС)](../global/operating-system.md)

> Ця стаття буде досить великих розмірів, так як необхідної, важливої інформації немало. Інформація буде подана таким самим способом, як й у оригіналу, тобто тезами. Якщо щось не до кінця зрозуміло, то це не смертельно. Тема досить обширна та складна, щоб її повністю опанувати, потрібен досвід. Для ознайомлення та суто загального поняття досить й інформації зі статті, посилання на яку вище.

### Процес і управління процесами

**Процес**: примірник програми, що виконується.

- Стан виконання: лічильник програм, покажчик стека
- Частини та зона тимчасового утримання: дані, стан регістра, займає стан в пам'яті
- Може знадобитися спеціальне обладнання: пристрої введення-виведення
    
Процес - це стан програми під час виконання та завантаження в пам'ять, тобто активний стан виконання.

#### Як виглядає процес?

![Process](images/process.png)

#### Тип стану

- Текст та данні: статичний стан, коли процес завантажується першим
- Купа / Heap: динамічно створюється під час виконання
- Стек / Stack: росте і зменшується; черга LIFO
    
#### Як ОС знає, що виконує процес?

Використовується:

* Лічильник програм
* Регістри процесора
* Вказівник стека

#### Блок керування процесом (PCB)

![PCB](images/pcb.png)

* PCB створюється, коли створюється процес
* Деякі поля оновлюються при зміні стану процесу, наприклад. відображення пам'яті
* або інші поля, які дуже часто змінюються, наприклад, ліічильник програм

#### Як використовується PCB?

![howpcbisused](images/howpcbisused.png)

#### Перемикач контексту

- Механізм, що використовується для перемикання від контексту одного процесу до іншого в ЦП.

- Вони затратні!
	- прямі затрати: кількість циклів для інструкцій завантаження та зберігання.
	- непрямі затрати: холодний кеш (аналогія з непрогрітим двигуном). Коли кеш горячий, більшість даних процесу знаходиться в кеші, тому продуктивність процесу буде найкращою.


Іноді бувають ситуації, коли нам доводиться перемикати контекст (процес з високим пріоритетом, розподіл часу тощо)

#### Життєвий цикл процесу

![processlifecycle](images/processlifecycle.png)

ЦП може виконувати процес, коли процес знаходиться в стані Running або Ready.

#### Створення процесу

Механізми:

- вилка / fork:
	- копіює "батьківську" PCB в нову дочірню PCB
	- дитина містить виконання за вказівкою після fork
    
- виконавчий / exec:
	- замінити дочірнє зображення
	- завантажити нову програму та почати з першої інструкції
   
#### Яка роль планувальника ЦП?

Планувальник ЦП визначає, який із готових процесів буде надіслано до ЦП, щоб почати працювати, і як довго він повинен працювати.

ОС повинна:

* випереджувати / preempt - переривати і зберігати поточний контекст
* планувати / schedule - запустити планувальник, щоб вибрати наступний процес
* диспетчеризувати / dispatch - відправити процес 2 перемикатись на його контекст

#### Планування проектувальних рішень

![timeslice](images/timeslice.png)

* Які значення мають відповідні тимчасові фрагменти?
* Показники для вибору наступного процесу для запуску?

#### Введення-Виведення / I/O

Процес може звільнитися в черзі готовності кількома способами.

![io](images/io.png)

#### Чи може процес взаємодіяти?

##### Міжпроцесний зв'язок:

Механізми IPC:

- передача даних/інформації між адресним простором 
- підтримання захисту та ізоляції 
- забезпечення гнучкості і продуктивністі

Два типи моделей IPC:

1. Передача повідомлення IPC
![messagepassing](images/messagepassing.png)

* ОС забезпечує загальний буфер лінії зв'язку
* Процеси можуть записувати (відправляти) / write(send), читати (отримувати) / read(receive) повідомлення в/з каналу 
Переваги: ОС керує каналом
Недоліки: накладні витрати
    
2. Спільна пам'ять IPC

![sharedmemory](images/sharedmemory.png)

* ОС встановлює спільний канал і відображає його в адресному просторі кожного процесу 
* Обробляє безпосередньо запис (відправлення), читання (отримання) повідомлення в/з цієї пам'яті

Переваги: ОС не працює після встановлення спільного каналу
Недоліки: Повторна реалізація великої кількості коду, який могла б зробити ОС

Загалом, зв’язок на основі спільної пам’яті краще, якщо відображення пам’яті між двома процесами амортизується на велику кількість повідомлень.


> Інформацію для статті було взято та перекладено на українську з репозиторію GitHub [Aniruddha Tapas](https://github.com/Aniruddha-Tapas). Оригінал статті за посиланням - https://github.com/Aniruddha-Tapas/Operating-Systems-Notes